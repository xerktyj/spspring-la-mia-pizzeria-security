<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
		integrity="sha384-4LISF5TTJX/fLmGSxO53rV4miRxdg84mZsxmO8Rx5jGtp/LbrixFETvWa5a6sESd" crossorigin="anonymous">
	<title>Pizzeria Napoli</title>
</head>

<body>

	<header>
		<div th:replace="fragments/fragments :: navbar_home">
		</div>
	</header>
	
<section>
	<div class="container mt-2">
		<div class="row">
			<div class=" col-lg-12 mt-1">
				<div class="col-12 mb-2	d-flex justify-content-center">
					<h1>Pizza</h1>
				</div>
				<div class="col-12" th:if="${pizza != null}">
					<div class="card mb-4">
						<h3>Nome: </h3> <span th:text="${pizza.name}"> </span>
						<h3>Descrizione: </h3> <span th:text="${pizza.description}"> </span>
						<h3>Prezzo: </h3> <span th:text="${pizza.price} + 'â‚¬'"> </span>
						<h3>Foto: </h3> <img th:src="@{|${pizza.photo}|}"> </img>
					</div>
					<div th:if="${(pizza.ingredients).size() > 0}">
						<h3>Ingredienti:</h3>
						<ul th:each="ingredienti : ${pizza.ingredients}">
							<li th:text="${ingredienti.name}"></li>
								<a sec:authorize="hasAuthority('ADMIN')" th:href="@{/pizza/ingredient/{id} (id =${ingredienti.id})}"> <i
										class="bi bi-caret-right"></i></a>
						</ul>
					</div>
					<div>
						<h3>Offerte speciali in corso</h3>
						<p th:if="${offer == null}">Non ci sono offerte attualmente</h1>
						<p th:if="${offer != null}" th:text="${offer}"></p>											
					</div>
					<div sec:authorize="hasAuthority('ADMIN')">
						<h5>Modifica Pizza</h5>
						<a th:href="@{/home/pizze/editpizza/{id} (id=${pizza.id})}" class="btn btn-primary mb-2">Modifica</a>
						<div>
							<form th:action="@{/home/pizze/delete/{id} (id=${pizza.id})}" method="post">
								<button class="btn btn-danger" type="submit"
									th:data-confirm-delete="|Sei sicuro di voler cancellare questa pizza?|"
									onclick="if(!confirm(this.getAttribute('data-confirm-delete')))return false">Delete</button>
							</form>
						</div>
					</div>
					<div sec:authorize="hasAuthority('ADMIN')">
						<h5>Offerta Speciale</h5>
						<a 	 th:href="@{/home/pizze/addoffer/	{id} (id=${pizza.id})}"
							class="btn btn-primary mb-2">Aggiungi</a>
						<a th:href="@{/pizza/specialoffers/{id} (id=${pizza.id})}" class="btn btn-primary mb-2">Storico
							Offerte</a>
					</div>
				</div>
			</div>
			<div class="col-12">
				<div th:if="${deleteError}">
					<h1>non puoi cancellare la seguente pizza prima devi cancellare i suoi riferimenti (le offerte
						associate)</h1>
				</div>
				<div th:if="${deleteCorrect}">
					<h1>Hai cancellato la pizza e tutti i suoi riferimenti</h1>
				</div>
			</div>
		</div>
	</div>
</section>


	<script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.bundle.min.js}"></script>

</body>

</html>